---
title: vim 总结
date: 2016-06-05
tags: [开发工具,Vim]
---

在终端，我们经常使用的文本编辑器就是Vim。对于新手简直头痛，慢慢解决它。

<!-- more -->

## 安装 pathogen

方便管理各种插件和文件。

```
mkdir -p ~/.vim/autoload ~/.vim/bundle && \
curl -LSso ~/.vim/autoload/pathogen.vim https://tpo.pe/pathogen.vim

#
# 环境变量配置
# 创建.vimrc 写入一下代码

execute pathogen#infect()
syntax on
filetype plugin indent on

#
# 以后安装插件 ~/.vim/bundle 将会自动添加到  ‘runtimepath’
#

# 安装vim-colors-solarized ，一款vim颜色配置

[vim-colors-solarized](https://github.com/altercation/vim-colors-solarized)

```

## 常用快捷操作

## 常用快捷键

这里的快捷键是我配置好的可用的。

```bash
;fl # 换出菜单列表
nw  # 窗口切换

# 可以直接在Tab之间切换。
gt # 后一个Tab标签
gT # 前一个Tab标签
;q # 关闭一个标签

ctrl-f # 下一页 f 就是`forword`
ctrl-b # 上一页 b 就是`backward`  

;cc 代码注释
;cu 取消代码注释
```

## 基础使用

- `inoremap` (Insert Mode)就只在插入(insert)模式下生效
- `vnoremap` (Visual Mode)只在visual模式下生效
- `nnoremap` (Normal Mode)就在normal模式下(狂按esc后的模式)生效

### 快捷键通配符

快捷键通配符 `<leader>` 相当于是一个通用的命令符，默认好像是`\`，你可以在`.vimrc`中将他改为任意一个按键，在我们这个配置我改为了冒号`;`

```
" 定义快捷键的前缀，即 <Leader>
let mapleader=";"
```

### 插入命令

```bash
a # → 在光标所在字符后插入  
A # → 在光标所在字符尾插入  
i # → 在光标所在字符前插入  
I # → 在光标所在行行首插入  
o # → 在光标下插入新行  
O # → 在光标上插入新行  
```

### 删除命令

```bash
x   # → 删除关闭所在处字符  
nx  # → 删除关闭所在处n个字符  
dd  # → 删除光标所在行，
ndd # → 删除n行  
dG  # → 删除光标所在行到文件末尾内容  
D   # → 删除光标所在处到行尾内容  
:n1,n2d # → 删除指定范围的行 如：1,2d  
```

### 定位命令

```bash
:set number   #→ 设置行号 简写set nu  
:set nonu   #→ 取消行号  
gg  #→ 到第一行  
G   #→ 到最后一行  
nG  #→ 到第n行  
:n  #→ 到第n行  
S   #→ 移至行尾  
0   #→ 移至行尾  
hjkl #→ 前下上后  

w   #→ 到下一个单词的开头  
b   #→ 与w相反  
e   #→ 到下一个单词的结尾。  
ge  #→ 与e相反  

0   #→ 到行头  
^   #→ 到本行的第一个非blank字符  
$   #→ 到行尾  
g_  #→ 到本行最后一个不是blank字符的位置。  
fa  #→ 到下一个为a的字符处，你也可以fs到下一个为s的字符。  
t,  #→ 到逗号前的第一个字符。逗号可以变成其它字符。  
3fa #→ 在当前行查找第三个出现的a。  
F 和 T → 和 f 和 t 一样，只不过是相反方向。  

zz # 将当前行置于屏幕中间（不是转载…）  
zt # 将当前行置于屏幕顶端（不是猪头~）  
zb # 底端啦~  
```

### 复制剪切

> `yy` 和 p 的组合键，或者 `dd` 和 p 的组合键

```bash
yy    # → 复制当前行  
nyy   # → 复制当前行以下n行  
dd    # → 剪切当前行  
ndd   # → 剪切当前行以下n 行  
p、P  # → 粘贴在当前光标所在行或行上  
2dd   # → 删除2行  
3p    # → 粘贴文本3次  
```

### 简单排版

```bash
:ce(nter)  # 居中显示光标所在行
:ri(ght)   # 靠右显示光标所在行
:le(ft)    # 靠左显示光标所在行
J          # 将光标所在下一行合并到光标所在行

>>         # 光标所在行增加缩进(一个tab)
<<         # 光标所在行减少缩进(一个tab)

n>>        # 光标所在行开始的n行增加缩进
n<<        # 光标所在行开始的n行减少缩进
```


### 保存退出

```
:w new_filename     # → 保存为指定文件  
:w   # → 保存修改  
:wq  # → 保存修改并推出  
ZZ   # → 快捷键，保存修改并推出  
:q!  # → 不保存修改推出  
:wq! # → 保存修改并推出（文件所有者，root权限的用户）  
```

### 整页翻页

```bash
ctrl-f # 下一页 f 就是`forword`
ctrl-b # 上一页 b 就是`backward`  
```

### 替换

#### 替换取消

```bash
r # → 取代关闭所在处字符  
R # → 从光标所在处开始替换字符，摁ESC结束  
u # → 取消上一步操作  
ctrl + r # → 返回上一步  
```

#### 快捷替换

可视化模式下选中其中一个，接着键入 ctrl-n，你会发现第二个该字符串也被选中了，持续键入 ctrl-n，你可以选中所有相同的字符串，把这个功能与 ctrlsf 结合

#### 精确替换

vim 有强大的内容替换命令，进行内容替换操作时，注意：如何指定替换文件范围、是否整词匹配、是否逐一确认后再替换。

```
:[range]s/{pattern}/{string}/[flags]
```

- 如果在当前文件内替换，[range] 不用指定，默认就在当前文件内；
- 如果在当前选中区域，[range] 也不用指定，在你键入替换命令时，vim 自动将生成如下命令：`:'<,'>s/{pattern}/{string}/[flags]`
- 你也可以指定行范围，如，第三行到第五行：`:3,5s/{pattern}/{string}/[flags]`
- 如果对打开文件进行替换，你需要先通过 `:bufdo` 命令显式告知 vim 范围，再执行替换；
- 如果对工程内所有文件进行替换，先 `:args **/.cpp */*.h` 告知 vim 范围，再执行替换；

`:21,27s/^/#/g` 行首替换`#`替换（增加）掉  
`:ab mymail asdf@qq.com` 输入`mymail` 摁下空格自动替换成`asdf@qq.com`  


### 开关注释

- `;cc`，注释当前选中文本，如果选中的是整行则在每行首添加 `//`，如果选中一行的部分内容则在选中部分前后添加分别 `/**/`；
- `;cu`，取消选中文本块的注释。

### 工程文件菜单

自定义快捷键

```shell
;fl          # 显示文件菜单 file list
```

自带快捷键

```bash
shift+i      # 显示/隐藏隐藏文件
t       # 在新 Tab 中打开选中文件/书签，并跳到新 Tab
T       # 在新 Tab 中打开选中文件/书签，但不跳到新 Tab
i       # split 一个新窗口打开选中文件，并跳到该窗口
gi      # split 一个新窗口打开选中文件，但不跳到该窗口
s       # vsplit 一个新窗口打开选中文件，并跳到该窗口
gs      # vsplit 一个新 窗口打开选中文件，但不跳到该窗口

ctrl + w + h    # 光标 focus 左侧树形目录
ctrl + w + l    # 光标 focus 右侧文件显示窗口
ctrl + w + w    # 光标自动在左右侧窗口切换
ctrl + w + r    # 移动当前窗口的布局位置
o       # 在已有窗口中打开文件、目录或书签，并跳到该窗口
go      # 在已有窗口 中打开文件、目录或书签，但不跳到该窗口

!       # 执行当前文件
O       # 递归打开选中 结点下的所有目录
x       # 合拢选中结点的父目录
X       # 递归 合拢选中结点下的所有目录
e       # Edit the current dif

双击    相当于 NERDTree-o
中键    对文件相当于 NERDTree-i，对目录相当于 NERDTree-e

D       # 删除当前书签
#
P       # 跳到根结点
p       # 跳到父结点
K       # 跳到当前目录下同级的第一个结点
J       # 跳到当前目录下同级的最后一个结点
k       # 跳到当前目录下同级的前一个结点
j       # 跳到当前目录下同级的后一个结点

C       # 将选中目录或选中文件的父目录设为根结点
u       # 将当前根结点的父目录设为根目录，并变成合拢原根结点
U       # 将当前根结点的父目录设为根目录，但保持展开原根结点
r       # 递归刷新选中目录
R       # 递归刷新根结点
m       # 显示文件系统菜单
cd      # 将 CWD 设为选中目录

I       # 切换是否显示隐藏文件
f       # 切换是否使用文件过滤器
F       # 切换是否显示文件
B       # 切换是否显示书签
#
q       # 关闭 NerdTree 窗口
?       # 切换是否显示 Quick Help
```

#### 切割窗口

```bash
:new      # 水平切割窗口
:split    # 水平切割窗口(或者直接输入   :sp  也可以)
:vsplit   # 垂直切割( 也可以  :vs  )
```

### Tab操作

#### 多tab窗口拆分

```bash
:tabnew [++opt选项] ［＋cmd］ 文件            #建立对指定文件新的tab
:tabc      #关闭当前的tab
:tabo      #关闭所有其他的tab
:tabs      #查看所有打开的tab
:tabp      #前一个
:tabn      #后一个
```

#### tab切换

```bash
# 下面为自定义快捷键
tnew #新建tab
tn #后一个 tab
tp #前一个 tab

# 窗口切换
nw

# 标准模式下：
gt , gT #可以直接在tab之间切换。

# 还有很多他命令， 看官大人自己， :help table 吧。
Ctrl+ww # 移动到下一个窗口
# 或者 先按组合键ctrl+w ，然后都松开，然后通过j/k/h/l(等于vim移动的方向键) 来移动大哦哦左/上/下/右的窗口
Ctrl+wj #移动到下方的窗口
Ctrl+wk #移动到上方的窗口
```

### 搜索和搜索替换命令

`/string` → 搜索指定字符串，搜索时忽略大小写命令 `:set ic`  
`n` → 搜索指定字符串的下一个出现位置  
`#` → 搜索指定字符串的上一个出现位置  
`:%s/old/new/g` → 全文替换指定字符串，`%s` → 全文替换，`1,3s`指定范围替换，`g`全局替换， `c`询问替换  

`:vimgrep /dostuff()/j ../**/*.c` 搜索文件内容  

### 搜索文件

`:lvim /\<\(house\|home\)\>/gj *.txt`  搜索  
`:lw`  列出搜索结果  

### 自动补齐

```bash
Ctrl-n      #匹配下一个关键字
Ctrl-p      #匹配上一个关键字
```

### 关闭窗口

```bash
:close  #最后一个窗口不能使用此命令，可以防止意外退出vim。
:q      #如果是最后一个被关闭的窗口，那么将退出vim。
```

### 片段折叠

```bash
zfap  #创建一个段落的折行
zc    #关闭折行
zo    #打开折行
```



### 其它小技巧

- 导入命令执行接货`:r 文件路径/文件名`命令
- 找命令 `:!which ls` 不推出vim运行命令
- 查看编辑时间 `:!date`
- 组合使用 `:r !date`将当前编辑时间导入当前文本光标所在行
- gU (变大写)
- gu (变小写)


## 参考

[vim]([vim](http://www.cnblogs.com/liu_xf/archive/2011/05/16/2047554.html))
[vim-web](https://github.com/jaywcjlove/vim-web)
